{"version":3,"sources":["..\\..\\..\\..\\assets\\js/assets\\js\\player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","squashDuration","maxMoveSpeed","accel","jumpAudio","default","type","AudioClip","onLoad","jumpAction","setJumpAction","node","runAction","accLeft","accRight","xSpeed","minPosX","parent","width","maxPosX","setInputControl","playJumpAudio","audioEngine","playEffect","deltaPos","v2","easeObj","easeCubicActionOut","jumpUp","moveBy","easing","easeCubicActionIn","jumpDown","callback","callFunc","squash","scaleTo","stretch","scaleBack","action","sequence","repeatForever","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","macro","KEY","a","d","onKeyReleased","TOUCH_ONE_BY_ONE","onTouchBegan","touch","touchLoc","getLocation","x","winSize","ouTouchEnded","start","update","dt","Math","abs"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\js","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n      jumpHeight: 0,\r\n      jumpDuration: 0,\r\n      squashDuration: 0,\r\n      maxMoveSpeed: 0,\r\n      accel: 0,\r\n\r\n      jumpAudio: {\r\n        default: null,\r\n        type: cc.AudioClip\r\n      }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n      this.jumpAction = this.setJumpAction();\r\n      this.node.runAction(this.jumpAction);\r\n\r\n      this.accLeft = false;\r\n      this.accRight = false;\r\n\r\n      this.xSpeed = 0;\r\n\r\n      this.minPosX = (-this.node.parent.width / 2) + 39;\r\n      this.maxPosX = (this.node.parent.width / 2) - 39;\r\n\r\n      this.setInputControl();\r\n    },\r\n\r\n    playJumpAudio () {\r\n      cc.audioEngine.playEffect(this.jumpAudio, false);\r\n    },\r\n\r\n    setJumpAction () {\r\n      var deltaPos = cc.v2(0, this.jumpHeight);\r\n      var easeObj = cc.easeCubicActionOut();\r\n      var jumpUp = cc.moveBy(this.jumpDuration, deltaPos).easing(easeObj);\r\n\r\n      deltaPos = cc.v2(0, -this.jumpHeight);\r\n      easeObj = cc.easeCubicActionIn();\r\n      var jumpDown = cc.moveBy(this.jumpDuration, deltaPos).easing(easeObj);\r\n\r\n      var callback = cc.callFunc(this.playJumpAudio, this);\r\n\r\n      var squash = cc.scaleTo(this.squashDuration, 1, 0.6);\r\n      var stretch = cc.scaleTo(this.squashDuration, 1, 1.2);\r\n      var scaleBack = cc.scaleTo(this.squashDuration, 1, 1);\r\n\r\n      var action = cc.sequence(squash, stretch, jumpUp, scaleBack, jumpDown, callback);\r\n      return cc.repeatForever(action);\r\n    },\r\n\r\n    setInputControl () {\r\n      var self = this;\r\n\r\n      cc.eventManager.addListener({\r\n        event: cc.EventListener.KEYBOARD,\r\n\r\n        onKeyPressed (keyCode, event) {\r\n          switch (keyCode) {\r\n            case cc.macro.KEY.a:\r\n              self.accLeft = true;\r\n              self.accRight = false;\r\n              break;\r\n            case cc.macro.KEY.d:\r\n              self.accRight = true;\r\n              self.accLeft = false;\r\n              break;\r\n          }\r\n        },\r\n        onKeyReleased (keyCode, event) {\r\n          switch (keyCode) {\r\n            case cc.macro.KEY.a:\r\n              self.accLeft = false;\r\n              break;\r\n            case cc.macro.KEY.d:\r\n              self.accRight = false;\r\n              break;\r\n          }\r\n        }\r\n      }, self.node);\r\n\r\n      cc.eventManager.addListener({\r\n        event: cc.EventListener.TOUCH_ONE_BY_ONE,\r\n\r\n        onTouchBegan (touch, event) {\r\n          var touchLoc = touch.getLocation();\r\n\r\n          if (touchLoc.x >= cc.winSize.width / 2) {\r\n            self.accRight = true;\r\n            self.accLeft = false;\r\n          } else {\r\n            self.accLeft = true;\r\n            self.accRight = false;\r\n          }\r\n        },\r\n\r\n        ouTouchEnded (touch, event) {\r\n          self.accLeft = false;\r\n          self.accRight = false;\r\n        }\r\n      }, self.node);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n      if (this.accLeft) {\r\n        this.xSpeed -= this.accel * dt;\r\n      } else if (this.accRight) {\r\n        this.xSpeed += this.accel * dt;\r\n      }\r\n\r\n      if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\r\n        this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n      }\r\n\r\n      this.node.x += this.xSpeed * dt;\r\n\r\n      if (this.node.x > this.maxPosX) {\r\n        this.node.x = this.maxPosX;\r\n        this.xSpeed = 0;\r\n      } else if (this.node.x < this.minPosX) {\r\n        this.node.x = this.minPosX;\r\n        this.xSpeed = 0;\r\n      }\r\n    },\r\n});\r\n"]}