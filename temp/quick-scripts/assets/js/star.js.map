{"version":3,"sources":["star.js"],"names":["cc","Class","extends","Component","properties","pickRadius","onLoad","getPlayerDistance","playerPos","game","player","getPosition","dist","node","position","sub","mag","onPicked","spawnNewStar","gainScore","destroy","start","update","dt","opacityRatio","timer","starDuration","minOpacity","opacity","Math","floor","pbar","progressBar","progress"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACVC,oBAAY;AADF,KAHP;;AAOL;;AAEAC,UATK,oBASK,CAET,CAXI;AAaLC,qBAbK,+BAagB;AACnB,YAAIC,YAAY,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,WAAjB,EAAhB;AACA,YAAIC,OAAO,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBP,SAAvB,EAAkCQ,GAAlC,EAAX;;AAEA,eAAOJ,IAAP;AACD,KAlBI;AAoBLK,YApBK,sBAoBO;AACV,aAAKR,IAAL,CAAUS,YAAV;;AAEA,aAAKT,IAAL,CAAUU,SAAV;;AAEA,aAAKN,IAAL,CAAUO,OAAV;AACD,KA1BI;AA4BLC,SA5BK,mBA4BI,CAER,CA9BI;AAgCLC,UAhCK,kBAgCGC,EAhCH,EAgCO;AACV,YAAI,KAAKhB,iBAAL,KAA2B,KAAKF,UAApC,EAAgD;AAC9C,iBAAKY,QAAL;AACA;AACD;;AAED,YAAIO,eAAe,IAAI,KAAKf,IAAL,CAAUgB,KAAV,GAAkB,KAAKhB,IAAL,CAAUiB,YAAnD;AACA,YAAIC,aAAa,EAAjB;;AAEA,aAAKd,IAAL,CAAUe,OAAV,GAAoBD,aAAaE,KAAKC,KAAL,CAAWN,gBAAgB,MAAMG,UAAtB,CAAX,CAAjC;;AAEA,YAAII,OAAO,KAAKtB,IAAL,CAAUuB,WAArB;AACA,YAAIC,WAAWF,KAAKE,QAApB;;AAEAA,mBAAW,IAAI,KAAKxB,IAAL,CAAUgB,KAAV,GAAkB,KAAKhB,IAAL,CAAUiB,YAA3C;;AAEAK,aAAKE,QAAL,GAAgBA,QAAhB;AACD;AAjDI,CAAT","file":"star.js","sourceRoot":"..\\..\\..\\..\\assets\\js","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n      pickRadius: 0,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\r\n    },\r\n\r\n    getPlayerDistance () {\r\n      var playerPos = this.game.player.getPosition();\r\n      var dist = this.node.position.sub(playerPos).mag();\r\n\r\n      return dist;\r\n    },\r\n\r\n    onPicked () {\r\n      this.game.spawnNewStar();\r\n\r\n      this.game.gainScore();\r\n\r\n      this.node.destroy();\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n      if (this.getPlayerDistance() < this.pickRadius) {\r\n        this.onPicked();\r\n        return;\r\n      }\r\n\r\n      var opacityRatio = 1 - this.game.timer / this.game.starDuration;\r\n      var minOpacity = 50;\r\n\r\n      this.node.opacity = minOpacity + Math.floor(opacityRatio * (255 - minOpacity));\r\n\r\n      var pbar = this.game.progressBar;\r\n      var progress = pbar.progress;\r\n\r\n      progress = 1 - this.game.timer / this.game.starDuration;\r\n\r\n      pbar.progress = progress;\r\n    },\r\n});\r\n"]}